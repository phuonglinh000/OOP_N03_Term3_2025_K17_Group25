<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>T·∫°o Phi·∫øu M∆∞·ª£n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
    <div class="bg-white p-5 rounded shadow" style="min-width: 400px;">
        <h3 class="text-center mb-4">üìÑ T·∫°o Phi·∫øu M∆∞·ª£n S√°ch</h3>

        <!-- C·∫£nh b√°o l·ªói n·∫øu ng√†y tr·∫£ qu√° h·∫°n -->
        <div th:if="${param.loi}" class="alert alert-danger">
            Ng√†y tr·∫£ kh√¥ng ƒë∆∞·ª£c qu√° 15 ng√†y sau ng√†y m∆∞·ª£n.
        </div>

        <form th:action="@{/phieu-muon/tao}" th:object="${phieuMuonMoi}" method="post">
            <!-- T√™n ng∆∞·ªùi m∆∞·ª£n -->
            <div class="mb-3">
                <label class="form-label">T√™n ng∆∞·ªùi m∆∞·ª£n:</label>
                <input type="text" th:field="*{nguoiDung.ten}" class="form-control" required>
            </div>

            <!-- M√£ s√°ch -->
            <div class="mb-3">
                <label class="form-label">M√£ s√°ch:</label>
                <input type="text" th:field="*{sach.ma}" class="form-control" required>
            </div>

            <!-- T√™n s√°ch -->
            <div class="mb-3">
                <label class="form-label">T√™n s√°ch:</label>
                <input type="text" th:field="*{sach.tenSach}" class="form-control" required>
            </div>

            <!-- T√°c gi·∫£ -->
            <div class="mb-3">
                <label class="form-label">T√°c gi·∫£:</label>
                <input type="text" th:field="*{sach.tacGia}" class="form-control" required>
            </div>

            <!-- Ng√†y m∆∞·ª£n -->
            <div class="mb-3">
                <label class="form-label">Ng√†y m∆∞·ª£n:</label>
                <input type="date" id="ngayMuon" th:field="*{ngayMuon}" class="form-control" required>
            </div>

            <!-- Ng√†y tr·∫£ -->
            <div class="mb-4">
                <label class="form-label">Ng√†y tr·∫£ (t·ªëi ƒëa 15 ng√†y sau ng√†y m∆∞·ª£n):</label>
                <input type="date" id="ngayTra" th:field="*{ngayTra}" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-success w-100 fw-bold">X√°c Nh·∫≠n</button>
        </form>
    </div>
</div>

<!-- Script ki·ªÉm so√°t ng√†y tr·∫£ -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ngayMuonInput = document.getElementById('ngayMuon');
        const ngayTraInput = document.getElementById('ngayTra');

        ngayMuonInput.addEventListener('change', function () {
            const ngayMuon = new Date(this.value);
            if (isNaN(ngayMuon)) {
                ngayTraInput.min = '';
                ngayTraInput.max = '';
                ngayTraInput.value = '';
                return;
            }

            const maxNgayTra = new Date(ngayMuon);
            maxNgayTra.setDate(maxNgayTra.getDate() + 15);

            const formatDate = date => date.toISOString().split('T')[0];

            ngayTraInput.min = formatDate(ngayMuon);
            ngayTraInput.max = formatDate(maxNgayTra);

            const currentNgayTra = new Date(ngayTraInput.value);
            if (currentNgayTra < ngayMuon || currentNgayTra > maxNgayTra) {
                ngayTraInput.value = '';
            }
        });
    });
</script>

</body>
</html>